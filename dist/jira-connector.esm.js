const i=require("./api/auth"),t=require("./api/board"),e=require("./api/issue"),s=require("./api/issueLinkType"),r=require("./api/priority"),o=require("./api/project"),h=require("./api/search"),n=require("./api/sprint"),p=require("./api/user"),u=require("./api/version"),a=function(a){if(!a.host)throw new Error("NO_HOST_ERROR");this.host=a.host,this.timeout=a.timeout,this.protocol=a.protocol?a.protocol:"https",this.path_prefix=a.path_prefix?a.path_prefix:"/",this.port=a.port,this.apiVersion=a.apiVersion||2,this.agileApiVersion="1.0",this.authApiVersion="1",this.webhookApiVersion="1.0",this.promise=a.promise||Promise,this.requestLib=a.requestLib,this.auth=new i(this),this.board=new t(this),this.issue=new e(this),this.issueLinkType=new s(this),this.priority=new r(this),this.project=new o(this),this.search=new h(this),this.sprint=new n(this),this.user=new p(this),this.version=new u(this)};(function(){this.buildURL=function(i,t){const e=this.path_prefix+"rest/api/"+(t||this.apiVersion)+i,{protocol:s,host:r}=this;return decodeURIComponent(`${s}://${r}${e}`)},this.buildAgileURL=function(i,t){const e=this.path_prefix+"rest/agile/"+(t||this.agileApiVersion)+i,{protocol:s,host:r}=this;return decodeURIComponent(`${s}://${r}${e}`)},this.buildAuthURL=function(i,t){const e=this.path_prefix+"rest/auth/"+(t||this.authApiVersion)+i,{protocol:s,host:r}=this;return decodeURIComponent(`${s}://${r}${e}`)},this.makeRequest=function(i,t){if(this.requestLib)return this.requestLib(i,t);const{method:e}=i;let s={method:e};if(i.headers&&(s.headers=i.headers),i.qs){let t=Object.keys(i.qs).map(t=>encodeURIComponent(t)+"="+encodeURIComponent(i.qs[t])).join("&");i.uri=`${i.uri}?${t}`}i.body&&(s.body=JSON.stringify(i.body));const{uri:r,parser:o}=i;return t?fetch(r,s).then(i=>o?o(i):i.json()).then(i=>t(null,i)).catch(i=>t(i)):fetch(r,s).then(i=>o?o(i):i.json()).then(i=>Promise.resolve(i)).catch(i=>Promise.reject(i))}}).call(a.prototype);export default a;
