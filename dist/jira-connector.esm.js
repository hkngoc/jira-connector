const t=require("./api/auth"),i=require("./api/board"),e=require("./api/issue"),s=require("./api/priority"),r=require("./api/project"),o=require("./api/search"),h=require("./api/sprint"),n=require("./api/user"),p=function(p){if(!p.host)throw new Error("NO_HOST_ERROR");this.host=p.host,this.timeout=p.timeout,this.protocol=p.protocol?p.protocol:"https",this.path_prefix=p.path_prefix?p.path_prefix:"/",this.port=p.port,this.apiVersion=p.apiVersion||2,this.agileApiVersion="1.0",this.authApiVersion="1",this.webhookApiVersion="1.0",this.promise=p.promise||Promise,this.requestLib=p.requestLib,this.auth=new t(this),this.board=new i(this),this.issue=new e(this),this.priority=new s(this),this.project=new r(this),this.search=new o(this),this.sprint=new h(this),this.user=new n(this)};(function(){this.buildURL=function(t,i){const e=this.path_prefix+"rest/api/"+(i||this.apiVersion)+t,{protocol:s,host:r}=this;return decodeURIComponent(`${s}://${r}${e}`)},this.buildAgileURL=function(t,i){const e=this.path_prefix+"rest/agile/"+(i||this.agileApiVersion)+t,{protocol:s,host:r}=this;return decodeURIComponent(`${s}://${r}${e}`)},this.buildAuthURL=function(t,i){const e=this.path_prefix+"rest/auth/"+(i||this.authApiVersion)+t,{protocol:s,host:r}=this;return decodeURIComponent(`${s}://${r}${e}`)},this.makeRequest=function(t,i){if(this.requestLib)return this.requestLib(t,i);const{method:e}=t;let s={method:e};if(t.headers&&(s.headers=t.headers),t.qs){let i=Object.keys(t.qs).map(i=>encodeURIComponent(i)+"="+encodeURIComponent(t.qs[i])).join("&");t.uri=`${t.uri}?${i}`}t.body&&(s.body=JSON.stringify(t.body));const{uri:r,parser:o}=t;return i?fetch(r,s).then(t=>o?o(t):t.json()).then(t=>i(null,t)).catch(t=>i(t)):fetch(r,s).then(t=>o?o(t):t.json()).then(t=>Promise.resolve(t)).catch(t=>Promise.reject(t))}}).call(p.prototype);export default p;
